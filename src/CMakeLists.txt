set (gfxbox2_LIB_INCLUDE_DIRS
  ${PROJECT_SOURCE_DIR}/include
)

include_directories(
  ${gfxbox2_LIB_INCLUDE_DIRS}
  ${CMAKE_CURRENT_BINARY_DIR}
  ${SYS_INCLUDE_DIRS}
)

set (gfxbox2_LIB_SRCS
  ${PROJECT_SOURCE_DIR}/src/utils.cpp
  ${PROJECT_SOURCE_DIR}/src/pixel.cpp
  ${PROJECT_SOURCE_DIR}/src/sdl_subsys.cpp
  ${PROJECT_SOURCE_DIR}/src/audio.cpp
# autogenerated files
  ${CMAKE_CURRENT_BINARY_DIR}/version.cpp
)

add_library (gfxbox2 STATIC ${gfxbox2_LIB_SRCS})
target_link_options(gfxbox2 PUBLIC ${gfxbox2_STATIC_LINKER_FLAGS})
target_compile_options(gfxbox2 PUBLIC ${gfxbox2_CXX_FLAGS})

target_link_libraries (
  gfxbox2
  ${CMAKE_THREAD_LIBS_INIT}
)

if( OFF AND (USE_STRIP) AND (NOT EMSCRIPTEN) )
add_custom_command(TARGET gfxbox2 POST_BUILD
                   COMMAND ${STRIP} ${CMAKE_CURRENT_BINARY_DIR}/${CMAKE_SHARED_LIBRARY_PREFIX}gfxbox2${CMAKE_SHARED_LIBRARY_SUFFIX}.${gfxbox2_VERSION_SHORT}
                   COMMENT "stripping gfxbox2"
                   VERBATIM
                   )
endif()

set_target_properties(
   gfxbox2
   PROPERTIES
   SOVERSION ${gfxbox2_VERSION_MAJOR}
   VERSION ${gfxbox2_VERSION_SHORT}
)
install (DIRECTORY ${PROJECT_SOURCE_DIR}/include/pixel DESTINATION include/)

macro (gfxbox2_CREATE_INSTALL_PKGCONFIG generated_file install_location)
  configure_file (${generated_file}.cmake ${CMAKE_CURRENT_BINARY_DIR}/${generated_file} @ONLY)
  install (FILES ${CMAKE_CURRENT_BINARY_DIR}/${generated_file} DESTINATION ${install_location})
endmacro (gfxbox2_CREATE_INSTALL_PKGCONFIG)
gfxbox2_create_install_pkgconfig (gfxbox2.pc lib${LIB_SUFFIX}/pkgconfig)

install(TARGETS gfxbox2 LIBRARY DESTINATION ${CMAKE_INSTALL_LIBDIR})

